(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();class h{constructor(){this.hourElem=document.getElementById("hour"),this.showHourElem=document.getElementById("show-hour"),this.showMinuteElem=document.getElementById("show-minute"),this.showSecondElem=document.getElementById("show-second"),this.showHour=localStorage.getItem("showHour")==="true",this.showMinute=localStorage.getItem("showMinute")==="true",this.showSecond=localStorage.getItem("showSecond")==="true",this.dateElem=document.getElementById("date"),this.showDateElem=document.getElementById("show-date"),this.showYearElem=document.getElementById("show-year"),this.showMonthElem=document.getElementById("show-month"),this.showDayElem=document.getElementById("show-day"),this.showDate=localStorage.getItem("showDate")==="true",this.showYear=localStorage.getItem("showYear")==="true",this.showMonth=localStorage.getItem("showMonth")==="true",this.showDay=localStorage.getItem("showDay")==="true",this.vibrationElem=document.getElementById("vibration"),this.showVibrationElem=document.getElementById("show-vibration"),this.enableVibrationElem=document.getElementById("enable-vibration"),this.showVibration=localStorage.getItem("showVibration")==="true",this.enableVibration=localStorage.getItem("enableVibration")==="true",this.batteryElem=document.getElementById("battery"),this.enableBatteryElem=document.getElementById("show-battery"),this.enableBattery=localStorage.getItem("enableBattery")==="true",this.latencyElem=document.getElementById("latency"),this.showLatencyElem=document.getElementById("show-latency"),this.pingServerElem=document.getElementById("ping-server"),this.refreshRateElem=document.getElementById("latency-refresh-rate"),this.showLatency=localStorage.getItem("showLatency")==="true",this.pingServer=localStorage.getItem("pingServer")||"google.com",this.refreshRate=localStorage.getItem("refreshRate")||1,this.themeElem=document.getElementById("theme"),this.theme=localStorage.getItem("theme")==="true",this.lockElem=document.getElementById("lock"),this.enablePinElem=document.getElementById("lock-method-pin"),this.enablePatternElem=document.getElementById("lock-method-pattern"),this.enablePinLock=localStorage.getItem("enablePinLock")==="true",this.enablePatternLock=localStorage.getItem("enablePatternLock")==="true",this.saveSettingsButton=document.getElementById("save-settings-button")}updateCheckboxes(){const e=localStorage.getItem("showHour")==="true",a=localStorage.getItem("showMinute")==="true",t=localStorage.getItem("showSecond")==="true",o=localStorage.getItem("showDate")==="true",n=localStorage.getItem("showYear")==="true",l=localStorage.getItem("showMonth")==="true",c=localStorage.getItem("showDay")==="true",i=localStorage.getItem("showVibration")==="true",u=localStorage.getItem("enableVibration")==="true",d=localStorage.getItem("enableBattery")==="true",m=localStorage.getItem("showLatency")==="true",g=localStorage.getItem("pingServer")||"google.com",b=localStorage.getItem("refreshRate")||1,w=localStorage.getItem("theme")==="true",y=localStorage.getItem("enablePinLock")==="true",p=localStorage.getItem("enablePatternLock")==="true";this.showHourElem.checked=e,this.showMinuteElem.checked=a,this.showSecondElem.checked=t,this.showDateElem.checked=o,this.showYearElem.checked=n,this.showMonthElem.checked=l,this.showDayElem.checked=c,this.showVibrationElem.checked=i,this.enableVibrationElem.checked=u,this.enableBatteryElem.checked=d,this.showLatencyElem.checked=m,this.pingServerElem.value=g,this.refreshRateElem.value=b,this.themeElem.checked=w,this.enablePinElem.checked=y,this.enablePatternElem.checked=p}updateHour(){const e=new Date;let a="";if(this.showHour){const t=e.getHours();a+=(t<10?"0":"")+t+":"}if(this.showMinute){const t=e.getMinutes();a+=(t<10?"0":"")+t+":"}if(this.showSecond){const t=e.getSeconds();a+=(t<10?"0":"")+t}this.hourElem.textContent=a}updateDate(){if(this.showDate){const e=new Date;let a="";if(this.showDay){const t=e.getDate();a+=(t<10?"0":"")+t+"-"}if(this.showMonth){const t=e.getMonth()+1;a+=(t<10?"0":"")+t+"-"}this.showYear&&(a+=e.getFullYear()),this.dateElem.textContent=a}else this.dateElem.textContent=""}updateVibration(){if("vibrate"in window.navigator){if(this.enableVibration){const e=this.enableHapticFeedback?[100,50,100]:[100];window.navigator.vibrate(e)}this.vibrationElem.textContent="Vibration : activ\xE9e"}else this.vibrationElem.textContent="La vibration n'est pas prise en charge",window.navigator.vibrate(0);this.showVibration?this.vibrationElem.style.display="block":this.vibrationElem.style.display="none"}updateBattery(){"getBattery"in navigator&&this.enableBattery?navigator.getBattery().then(e=>{this.batteryElem.textContent=`Batterie: ${(e.level*100).toFixed()}%`,e.level<.2&&this.enableVibration&&window.navigator.vibrate(1e3)}):this.batteryElem.textContent="La batterie n'est pas prise en charge"}updateLatency(){if(this.showLatency){const e=this.pingServerElem.value,a=performance.now();fetch(`https://${e}`,{mode:"no-cors"}).then(()=>{const t=performance.now();this.latency=Math.round(t-a),this.latencyElem.textContent=`Latence : ${this.latency} ms`}).catch(()=>{this.latency=null,this.latencyElem.textContent="Impossible de mesurer la latence"})}else this.latencyElem.textContent=""}updateTheme(){this.theme?document.body.classList.add("dark"):document.body.classList.remove("dark")}updateLock(){this.enablePinLock?this.lockElem.textContent="Verrouillage: PIN":this.enablePatternLock?this.lockElem.textContent="Verrouillage: Motif":this.lockElem.textContent="Verrouillage: Aucun"}saveSettings(){localStorage.setItem("showHour",this.showHourElem.checked),localStorage.setItem("showMinute",this.showMinuteElem.checked),localStorage.setItem("showSecond",this.showSecondElem.checked),localStorage.setItem("showDate",this.showDateElem.checked),localStorage.setItem("showYear",this.showYearElem.checked),localStorage.setItem("showMonth",this.showMonthElem.checked),localStorage.setItem("showDay",this.showDayElem.checked),localStorage.setItem("showVibration",this.showVibrationElem.checked),localStorage.setItem("enableVibration",this.enableVibrationElem.checked),localStorage.setItem("enableBattery",this.enableBatteryElem.checked),localStorage.setItem("showLatency",this.showLatencyElem.checked),localStorage.setItem("pingServer",this.pingServerElem.value),localStorage.setItem("refreshRate",this.refreshRateElem.value),localStorage.setItem("theme",this.themeElem.checked),localStorage.setItem("enablePinLock",this.enablePinElem.checked),localStorage.setItem("enablePatternLock",this.enablePatternElem.checked)}}const s=new h;s.updateCheckboxes();s.updateTheme();s.updateHour();setInterval(s.updateHour.bind(s),1e3);s.updateDate();s.updateVibration();s.updateBattery();setInterval(s.updateBattery.bind(s),1e3);s.updateLatency();setInterval(s.updateLatency.bind(s),s.refreshRate*1e3);s.saveSettingsButton.addEventListener("click",()=>{s.saveSettings()});class E extends h{constructor(){super(),this.currentValue=0,this.operation=null,this.pendingValue=null,this.displayElem=document.getElementById("display"),this.db=null,this.openDatabase(),this.initEventListeners()}openDatabase(){const e=window.indexedDB.open("CalculatorDB",1);e.onerror=()=>console.error("Failed to open database"),e.onsuccess=()=>{console.log("Calculator Database opened successfully"),this.db=e.result},e.onupgradeneeded=a=>{console.log("Upgrading calculator database"),a.target.result.createObjectStore("calculations",{keyPath:"id",autoIncrement:!0})}}initEventListeners(){document.querySelectorAll("button").forEach(a=>{a.addEventListener("click",()=>{const t=a.textContent;switch(t){case"+":case"-":case"*":case"/":this.updateVibration(),this.handleOperation(t);break;case"=":this.updateVibration(),this.handleEquals();break;case"C":this.updateVibration(),this.handleClear();break;case"+/-":this.handleNegate();break;case".":this.handleDecimal();break;case"":this.updateVibration(),this.handleBackspace();break;default:this.handleNumber(t)}})})}handleNumber(e){this.currentValue===0?this.currentValue=e:this.currentValue+=e,this.updateDisplay()}handleOperation(e){this.pendingValue!==null&&this.handleEquals(),this.pendingValue=this.currentValue,this.currentValue=0,this.operation=e}handleEquals(){if(this.operation===null)return;const e=parseFloat(this.pendingValue),a=parseFloat(this.currentValue);let t;switch(this.operation){case"+":t=e+a;break;case"-":t=e-a;break;case"*":t=e*a;break;case"/":t=e/a;break;default:return}this.saveCalculation(e,this.operation,a,t),this.pendingValue=null,this.currentValue=t,this.operation=null,this.updateDisplay()}handleClear(){this.currentValue=0,this.pendingValue=null,this.operation=null,this.updateDisplay()}handleNegate(){this.currentValue=-parseFloat(this.currentValue),this.updateDisplay()}handleDecimal(){this.currentValue.indexOf(".")===-1&&(this.currentValue+="."),this.updateDisplay()}handleBackspace(){this.currentValue!==0&&(this.currentValue=this.currentValue.toString().slice(0,-1),this.currentValue===""&&(this.currentValue=0),this.updateDisplay())}updateDisplay(){this.displayElem.value=this.currentValue}saveCalculation(e,a,t,o){const n={value1:e,operator:a,value2:t,result:o,timestamp:new Date},i=this.db.transaction(["calculations"],"readwrite").objectStore("calculations").add(n);i.onerror=()=>console.error("Failed to save calculation"),i.onsuccess=()=>console.log("Calculation saved successfully")}}new E;
